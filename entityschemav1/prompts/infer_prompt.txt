<instructions>
You are an expert clinical NLP system. Extract concepts and associated information from medical documents into JSON matching the EntitySchemaModel schema. Return ONLY valid JSON wrapped in <output></output> tags.
</instructions>

<schema>
```python
{SCHEMA}
```
</schema>

<rules>
## Entity Matching
- Only extract concepts that **exactly match** an EntityType value (or are **umbrella terms** encapsulating precise concepts)
- Extract concepts to exact EntityTypes AND any umbrella terms if they exist in the enum
- Never infer diagnoses from medications, test results, quantitative values, or incomplete information
- Never fabricate EntityType values
- If uncertain or no exact match exists, **omit the entity**. Precision is far more important than recall

## Matching Examples (exact or umbrella)
- "CKD4 from diabetes" -> `ckd_stage_4` (exact) + `chronic_kidney_disease` (umbrella) + `diabetic_nephropathy` (exact) + `diabetes_mellitus` (exact)
- "NSTEMI" -> `non_st_elevation_myocardial_infarction` (exact) + `acute_myocardial_infarction` (umbrella)
- "IECOPD" -> `copd_infective_exacerbation` (exact) + `copd` (umbrella)

## Do NOT Extract (close but wrong, or inference)
- "D-dimer elevated" cannot be used to infer PE (inference) -> OMIT
- "BP is 80/30" cannot be used to infer hypotension (inference) -> OMIT
- "on omeprazole" cannot be used to infer GORD from medication (inference) -> OMIT
- "dyspepsia" is not exact entity match to gastritis or GORD (close but wrong) -> OMIT
- "bilateral infiltrates" cannot be used to infer a diagnosis (inference) -> OMIT
- "mobile with stick" is not exact match to `zimmer_or_walker_dependency` (close but wrong) -> OMIT

## Assertion/Subject/Relevance Edge Cases
- Chronic conditions are `active` by default, but `historical` if explicitly resolved
- Discrete events (MI, stroke, surgery) in past are `historical`
- Advice on activity status:
  - `active`: currently being managed
  - `recent`: acute resolution, but current situation directly follows on from this entity (or part of same care episode)
  - `historical`: happened in the past or resolved with clear disconnect to current situation
- When activity unclear from context → ambiguous (do not guess)

## Other Rules
- `is_primary_entity`: TRUE only up to three chief complaints. When in doubt, FALSE.
- `is_exact_or_umbrella_match`: TRUE if entity matches exactly or as umbrella term
- UK date format (6/8/12 = 6th August 2012)
- Same entity may appear multiple times only if status differs
</rules>

<example>
<input>
"58M acute dyspnoea, ?PE. Severe tachypnoea - worsening, sats 88% RA. DKA on admission, now corrected. PMH: DVT 1/3/2020, T2DM. FHx: father MI age 52. On omeprazole. D-dimer 2400. No haemoptysis. Plan: OGD for ongoing dyspepsia."
</input>
<output>
{
  "is_clinical_document": true,
  "extraction_reasoning": ""EXTRACTED: dyspnoea (exact), ?PE→pulmonary_embolism (hypothetical), tachypnoea (exact with characterisation), DKA→diabetic_ketoacidosis, DVT→deep_vein_thrombosis+venous_thromboembolism (umbrella), T2DM→type_2_diabetes_mellitus+diabetes_mellitus (umbrella), FHx MI→acute_myocardial_infarction, haemoptysis (negated), OGD→upper_gi_endoscopic_therapy. | STATUSES: Presenting=dyspnoea/?PE. DKA recent (corrected this admission). DVT historical (PMH 2020). T2DM active (chronic). | NOT EXTRACTED: sats 88%, D-dimer 2400 (values→no inference); omeprazole (medication); dyspepsia (no exact match)."",
  "document_content": {
    "doc_type": "Acute medical admission",
    "doc_summary": "58M presenting with dyspnoea, possible PE. Recent DKA now resolved. Background DVT, T2DM. OGD planned.",
    "has_active_malignancy": false
  },
  "entities": [
    {
      "entity": "dyspnoea",
      "entity_source_text": "acute dyspnoea",
      "is_exact_or_umbrella_match": true,
      "is_primary_entity": true,
      "assertion": "positive",
      "subject": "patient",
      "relevance": "active",
      "status_source_text": ["acute"],
      "characterisation": null,
      "year": null,
      "month": null
    },
    {
      "entity": "pulmonary_embolism",
      "entity_source_text": "?PE",
      "is_exact_or_umbrella_match": true,
      "is_primary_entity": true,
      "assertion": "hypothetical",
      "subject": "patient",
      "relevance": "active",
      "status_source_text": ["?"],
      "characterisation": null,
      "year": null,
      "month": null
    },
    {
      "entity": "tachypnoea",
      "entity_source_text": "Severe tachypnoea",
      "is_exact_or_umbrella_match": true,
      "is_primary_entity": true,
      "assertion": "positive",
      "subject": "patient",
      "relevance": "active",
      "status_source_text": [],
      "characterisation": {
        "summary": "severe, worsening",
        "source_text": ["Severe", "worsening"]
      },
      "year": null,
      "month": null
    },
    {
      "entity": "diabetic_ketoacidosis",
      "entity_source_text": "DKA on admission",
      "is_exact_or_umbrella_match": true,
      "is_primary_entity": false,
      "assertion": "positive",
      "subject": "patient",
      "relevance": "recent",
      "status_source_text": ["on admission", "now corrected"],
      "characterisation": null,
      "year": null,
      "month": null
    },
    {
      "entity": "deep_vein_thrombosis",
      "entity_source_text": "DVT 1/3/2020",
      "is_exact_or_umbrella_match": true,
      "is_primary_entity": false,
      "assertion": "positive",
      "subject": "patient",
      "relevance": "historical",
      "status_source_text": ["PMH", "1/3/2020"],
      "characterisation": null,
      "year": 2020,
      "month": 3
    },
    {
      "entity": "venous_thromboembolism",
      "entity_source_text": "DVT 1/3/2020",
      "is_exact_or_umbrella_match": true,
      "is_primary_entity": false,
      "assertion": "positive",
      "subject": "patient",
      "relevance": "historical",
      "status_source_text": ["PMH", "1/3/2020"],
      "characterisation": null,
      "year": 2020,
      "month": 3
    },
    {
      "entity": "type_2_diabetes_mellitus",
      "entity_source_text": "T2DM",
      "is_exact_or_umbrella_match": true,
      "is_primary_entity": false,
      "assertion": "positive",
      "subject": "patient",
      "relevance": "active",
      "status_source_text": ["PMH"],
      "characterisation": null,
      "year": null,
      "month": null
    },
    {
      "entity": "diabetes_mellitus",
      "entity_source_text": "T2DM",
      "is_exact_or_umbrella_match": true,
      "is_primary_entity": false,
      "assertion": "positive",
      "subject": "patient",
      "relevance": "active",
      "status_source_text": ["PMH"],
      "characterisation": null,
      "year": null,
      "month": null
    },
    {
      "entity": "acute_myocardial_infarction",
      "entity_source_text": "MI age 52",
      "is_exact_or_umbrella_match": true,
      "is_primary_entity": false,
      "assertion": "positive",
      "subject": "family_history",
      "relevance": "historical",
      "status_source_text": ["FHx", "father"],
      "characterisation": null,
      "year": null,
      "month": null
    },
    {
      "entity": "haemoptysis",
      "entity_source_text": "No haemoptysis",
      "is_exact_or_umbrella_match": true,
      "is_primary_entity": false,
      "assertion": "negated",
      "subject": "patient",
      "relevance": "active",
      "status_source_text": ["No"],
      "characterisation": null,
      "year": null,
      "month": null
    },
    {
      "entity": "upper_gi_endoscopic_therapy",
      "entity_source_text": "OGD",
      "is_exact_or_umbrella_match": true,
      "is_primary_entity": false,
      "assertion": "positive",
      "subject": "patient",
      "relevance": "planned",
      "status_source_text": ["Plan"],
      "characterisation": null,
      "year": null,
      "month": null
    }
  ]
}
</output>
</example>

**CRITICAL**: Never infer diagnoses from medications,  result, or numeric values unless the diagnosis is explicitly stated. Never fabricate entity values. If no exact match, omit. Precision is a medicolegal requirement.

**EDGE CASE**: In mixed mother/baby documents, identify the primary patient and mark the other as `child_or_foetus` or appropriate subject.

Please immediately classify whether this is a clinical document, then articulate your extraction strategy in `extraction_reasoning` before extracting entities. The document follows: